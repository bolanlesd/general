# --- 1. Environment ---
export VISUAL=vim
export EDITOR="$VISUAL"

# --- 1.5 Keyboard Behavior Fix ---
bindkey -e  # Use Emacs mode for normal typing and Option + Arrow navigation

# --- 2. Load remote-compatible zshrc ---
REMOTE_ZSHRC=~/local_copy_zshrc
REMOTE_URL="https://raw.githubusercontent.com/bolanlesd/general/master-mac/zshrc"

curl --silent --fail --output "$REMOTE_ZSHRC" "$REMOTE_URL" \
  && echo "‚úÖ Downloaded latest zshrc from GitHub" \
  || echo "‚ùå Failed to download remote zshrc!"

source "$REMOTE_ZSHRC"

# --- 3. Git branch prompt using vcs_info ---
autoload -Uz vcs_info
zstyle ':vcs_info:*' enable git
zstyle ':vcs_info:git:*' formats '(%b)'
add-zsh-hook precmd vcs_info

setopt prompt_subst
PROMPT='%F{yellow}%* %F{blue}%~ %F{green}${vcs_info_msg_0_}%f $ '

# --- 4. Homebrew path ---
eval "$(/opt/homebrew/bin/brew shellenv)"

# --- 5. Completions (only once) ---
autoload -Uz compinit
compinit

# --- 6. (Optional) Only if needed here, otherwise it‚Äôs already in ~/local_copy_zshrc ---
# ‚úÖ Load Teleport Helper
if [[ -f /opt/homebrew/share/th/th.sh ]]; then
  echo "üîÑ Sourcing TH Helper..."
  source /opt/homebrew/share/th/th.sh
else
  echo "‚ùå TH Helper not found!"
fi

type th >/dev/null 2>&1 && echo "‚úÖ TH loaded successfully" || echo "‚ùå TH function still missing"

# Enable fzf history search (Ctrl+R replacement)
source "$(brew --prefix)/opt/fzf/shell/key-bindings.zsh"

echo "‚úÖ Loaded custom .zshrc"
source /opt/homebrew/share/th/th.sh